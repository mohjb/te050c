mysql> select f,count(*) from expense where year(d)=1900 group by f;
+------+----------+
| f    | count(*) |
+------+----------+
| 1116 |        1 |
| 1166 |        4 |
| 1565 |       13 |
| 1609 |        4 |
| 1677 |       17 |
| 1994 |      112 |
| 2268 |        4 |
| 2390 |        1 |
| 2507 |        3 |
| 2538 |        1 |
| 2540 |        2 |
| 2748 |        1 |
| 3407 |        1 |
| 3409 |        1 |
| 3978 |        1 |
| 4048 |        3 |
| 586  |        2 |
| 961  |        3 |
+------+----------+
18 rows in set (2.20 sec)

mysql> select * from expense where year(d)=1900;
+---------+------+--------+---------------------+----+----------+----------+
| row     | f    | i      | d                   | q  | p        | x        |
+---------+------+--------+---------------------+----+----------+----------+
|  148295 | 586  | 053203 | 1900-01-01 00:00:00 |  1 |    4.500 |    4.500 |
|  148296 | 586  | 111201 | 1900-01-01 00:00:00 |  1 |    2.000 |    2.000 |
|  221597 | 961  | 054014 | 1900-01-01 00:00:00 |  1 |    0.800 |    0.800 |
|  221598 | 961  | 123201 | 1900-01-01 00:00:00 |  1 |    1.000 |    1.000 |
|  221599 | 961  | 083005 | 1900-01-01 00:00:00 |  1 |    1.000 |    1.000 |
|  256566 | 1116 | 041102 | 1900-01-01 00:00:00 |  1 |  435.000 |  435.000 |
|  271361 | 1166 | 011408 | 1900-01-01 00:00:00 |  1 |    1.500 |    1.500 |
|  271362 | 1166 | 011401 | 1900-01-01 00:00:00 |  1 |    1.860 |    1.860 |
|  271363 | 1166 | 011412 | 1900-01-01 00:00:00 |  1 |    3.410 |    3.410 |
|  271364 | 1166 | 011911 | 1900-01-01 00:00:00 |  1 |    0.910 |    0.910 |
|  370935 | 1565 | 095408 | 1900-01-01 00:00:00 |  6 |    1.000 |    6.000 |
|  370936 | 1565 | 095411 | 1900-01-01 00:00:00 |  5 |    0.250 |    1.250 |
|  370937 | 1565 | 095411 | 1900-01-01 00:00:00 |  2 |    1.000 |    2.000 |
|  370938 | 1565 | 132003 | 1900-01-01 00:00:00 |  1 |   15.000 |   15.000 |
|  370939 | 1565 | 111102 | 1900-01-01 00:00:00 |  1 |    7.250 |    7.250 |
|  370940 | 1565 | 121303 | 1900-01-01 00:00:00 |  1 |    6.250 |    6.250 |
|  370941 | 1565 | 121303 | 1900-01-01 00:00:00 |  1 |    4.750 |    4.750 |
|  370942 | 1565 | 121302 | 1900-01-01 00:00:00 |  2 |    1.000 |    2.000 |
|  370943 | 1565 | 111201 | 1900-01-01 00:00:00 |  2 |    3.000 |    6.000 |
|  370944 | 1565 | 031238 | 1900-01-01 00:00:00 |  1 |    1.750 |    1.750 |
|  370945 | 1565 | 072302 | 1900-01-01 00:00:00 |  1 |   25.000 |   25.000 |
|  370946 | 1565 | 053110 | 1900-01-01 00:00:00 |  1 |    6.250 |    6.250 |
|  370947 | 1565 | 053205 | 1900-01-01 00:00:00 |  1 |   15.700 |   15.700 |
|  384317 | 1609 | 102003 | 1900-01-01 00:00:00 |  1 |   70.000 |   70.000 |
|  384318 | 1609 | 121102 | 1900-01-01 00:00:00 |  1 |    1.500 |    1.500 |
|  384319 | 1609 | 121304 | 1900-01-01 00:00:00 |  1 |    0.500 |    0.500 |
|  384320 | 1609 | 056120 | 1900-01-01 00:00:00 |  1 |    0.625 |    0.625 |
|  402926 | 1677 | 032202 | 1900-01-01 00:00:00 |  1 |    0.385 |    0.385 |
|  402927 | 1677 | 056123 | 1900-01-01 00:00:00 |  1 |    0.800 |    0.800 |
|  402928 | 1677 | 121303 | 1900-01-01 00:00:00 |  1 |    2.000 |    2.000 |
|  402929 | 1677 | 121303 | 1900-01-01 00:00:00 |  1 |    3.000 |    3.000 |
|  402930 | 1677 | 056121 | 1900-01-01 00:00:00 |  1 |    0.495 |    0.495 |
|  402931 | 1677 | 061203 | 1900-01-01 00:00:00 |  1 |    1.250 |    1.250 |
|  402932 | 1677 | 121303 | 1900-01-01 00:00:00 |  1 |    1.500 |    1.500 |
|  402933 | 1677 | 055211 | 1900-01-01 00:00:00 |  1 |    3.500 |    3.500 |
|  402934 | 1677 | 091406 | 1900-01-01 00:00:00 |  1 |    0.400 |    0.400 |
|  402935 | 1677 | 056103 | 1900-01-01 00:00:00 |  1 |    2.280 |    2.280 |
|  403047 | 1677 | 032107 | 1900-01-01 00:00:00 |  1 |    3.750 |    3.750 |
|  403048 | 1677 | 031286 | 1900-01-01 00:00:00 |  1 |    2.250 |    2.250 |
|  403049 | 1677 | 031234 | 1900-01-01 00:00:00 |  1 |    4.500 |    4.500 |
|  403050 | 1677 | 052002 | 1900-01-01 00:00:00 |  1 |    4.000 |    4.000 |
|  403051 | 1677 | 052008 | 1900-01-01 00:00:00 |  1 |    4.000 |    4.000 |
|  403052 | 1677 | 051125 | 1900-01-01 00:00:00 |  1 |    0.425 |    0.425 |
|  403053 | 1677 | 055205 | 1900-01-01 00:00:00 |  1 |    0.500 |    0.500 |
|  502249 | 1994 | 072301 | 1900-01-01 00:00:00 |  1 |   20.000 |   20.000 |
|  502250 | 1994 | 121302 | 1900-01-01 00:00:00 |  1 |    1.500 |    1.500 |
|  502251 | 1994 | 095419 | 1900-01-01 00:00:00 |  2 |    3.000 |    6.000 |
|  502252 | 1994 | 095419 | 1900-01-01 00:00:00 |  2 |    7.000 |   14.000 |
|  502253 | 1994 | 121101 | 1900-01-01 00:00:00 |  3 |    9.000 |   27.000 |
|  502254 | 1994 | 062103 | 1900-01-01 00:00:00 |  1 |   25.000 |   25.000 |
|  502255 | 1994 | 056114 | 1900-01-01 00:00:00 |  2 |    3.400 |    6.800 |
|  502256 | 1994 | 052008 | 1900-01-01 00:00:00 |  1 |   50.000 |   50.000 |
|  502257 | 1994 | 031280 | 1900-01-01 00:00:00 |  1 |    3.000 |    3.000 |
|  502258 | 1994 | 056103 | 1900-01-01 00:00:00 |  4 |    8.000 |   32.000 |
|  502259 | 1994 | 093403 | 1900-01-01 00:00:00 |  1 |    5.000 |    5.000 |
|  502260 | 1994 | 091106 | 1900-01-01 00:00:00 |  1 |    9.000 |    9.000 |
|  502261 | 1994 | 072305 | 1900-01-01 00:00:00 |  2 |    5.000 |   10.000 |
|  502262 | 1994 | 056104 | 1900-01-01 00:00:00 |  3 |    3.000 |    9.000 |
|  502263 | 1994 | 111102 | 1900-01-01 00:00:00 |  1 |   15.000 |   15.000 |
|  502264 | 1994 | 056129 | 1900-01-01 00:00:00 |  1 |    3.500 |    3.500 |
|  502265 | 1994 | 083005 | 1900-01-01 00:00:00 |  1 |    2.500 |    2.500 |
|  502266 | 1994 | 111102 | 1900-01-01 00:00:00 |  3 |    9.000 |   27.000 |
|  502267 | 1994 | 095201 | 1900-01-01 00:00:00 |  1 |   25.000 |   25.000 |
|  502290 | 1994 | 053107 | 1900-01-01 00:00:00 |  1 |   25.000 |   25.000 |
|  502291 | 1994 | 031227 | 1900-01-01 00:00:00 |  1 |    1.000 |    1.000 |
|  502292 | 1994 | 132003 | 1900-01-01 00:00:00 |  1 |   25.000 |   25.000 |
|  502293 | 1994 | 111201 | 1900-01-01 00:00:00 |  5 |   15.000 |   75.000 |
|  502294 | 1994 | 123201 | 1900-01-01 00:00:00 |  2 |   20.000 |   40.000 |
|  502295 | 1994 | 062201 | 1900-01-01 00:00:00 |  1 |   15.000 |   15.000 |
|  502296 | 1994 | 061101 | 1900-01-01 00:00:00 |  1 |    5.000 |    5.000 |
|  502297 | 1994 | 056103 | 1900-01-01 00:00:00 |  2 |    6.000 |   12.000 |
|  502298 | 1994 | 056102 | 1900-01-01 00:00:00 |  2 |    1.250 |    2.500 |
|  502299 | 1994 | 056114 | 1900-01-01 00:00:00 |  2 |    3.600 |    7.200 |
|  502300 | 1994 | 056201 | 1900-01-01 00:00:00 |  2 |  110.000 |  220.000 |
|  502301 | 1994 | 031410 | 1900-01-01 00:00:00 |  5 |    2.000 |   10.000 |
|  502302 | 1994 | 056123 | 1900-01-01 00:00:00 |  2 |    1.500 |    3.000 |
|  502303 | 1994 | 056102 | 1900-01-01 00:00:00 |  2 |    1.250 |    2.500 |
|  502304 | 1994 | 111201 | 1900-01-01 00:00:00 |  3 |    3.000 |    9.000 |
|  502305 | 1994 | 031235 | 1900-01-01 00:00:00 |  4 |   15.000 |   60.000 |
|  502306 | 1994 | 031260 | 1900-01-01 00:00:00 |  1 |   25.000 |   25.000 |
|  502307 | 1994 | 052006 | 1900-01-01 00:00:00 |  2 |   10.000 |   20.000 |
|  502308 | 1994 | 031104 | 1900-01-01 00:00:00 |  2 |   30.000 |   60.000 |
|  502309 | 1994 | 031401 | 1900-01-01 00:00:00 |  2 |    8.000 |   16.000 |
|  502310 | 1994 | 121302 | 1900-01-01 00:00:00 |  1 |    1.750 |    1.750 |
|  502311 | 1994 | 072102 | 1900-01-01 00:00:00 |  4 |   80.000 |  320.000 |
|  502312 | 1994 | 053215 | 1900-01-01 00:00:00 |  1 |   10.000 |   10.000 |
|  502313 | 1994 | 061302 | 1900-01-01 00:00:00 |  3 |   21.000 |   63.000 |
|  502314 | 1994 | 072201 | 1900-01-01 00:00:00 |  1 |    5.000 |    5.000 |
|  502315 | 1994 | 111102 | 1900-01-01 00:00:00 |  5 |   84.000 |  420.000 |
|  502354 | 1994 | 121201 | 1900-01-01 00:00:00 |  1 |   10.000 |   10.000 |
|  502355 | 1994 | 052001 | 1900-01-01 00:00:00 |  2 |    2.000 |    4.000 |
|  502356 | 1994 | 031280 | 1900-01-01 00:00:00 |  1 |    2.000 |    2.000 |
|  502357 | 1994 | 031280 | 1900-01-01 00:00:00 |  1 |    0.750 |    0.750 |
|  502358 | 1994 | 045201 | 1900-01-01 00:00:00 |  4 |    4.000 |   16.000 |
|  502359 | 1994 | 045401 | 1900-01-01 00:00:00 |  1 |    2.000 |    2.000 |
|  502360 | 1994 | 121304 | 1900-01-01 00:00:00 |  2 |    3.000 |    6.000 |
|  502361 | 1994 | 052012 | 1900-01-01 00:00:00 |  4 |    4.000 |   16.000 |
|  502362 | 1994 | 121304 | 1900-01-01 00:00:00 |  1 |    1.750 |    1.750 |
|  502396 | 1994 | 123204 | 1900-01-01 00:00:00 |  1 |   35.000 |   35.000 |
|  502397 | 1994 | 051201 | 1900-01-01 00:00:00 |  1 |   25.000 |   25.000 |
|  502398 | 1994 | 105003 | 1900-01-01 00:00:00 |  1 |   10.000 |   10.000 |
|  502399 | 1994 | 083007 | 1900-01-01 00:00:00 |  1 |    5.000 |    5.000 |
|  502400 | 1994 | 111201 | 1900-01-01 00:00:00 |  1 |    1.500 |    1.500 |
|  502401 | 1994 | 056109 | 1900-01-01 00:00:00 |  3 |    4.500 |   13.500 |
|  502402 | 1994 | 056116 | 1900-01-01 00:00:00 |  1 |    6.000 |    6.000 |
|  502403 | 1994 | 055209 | 1900-01-01 00:00:00 |  1 |    5.000 |    5.000 |
|  502404 | 1994 | 072201 | 1900-01-01 00:00:00 |  2 |    6.000 |   12.000 |
|  502405 | 1994 | 072306 | 1900-01-01 00:00:00 |  1 |    3.500 |    3.500 |
|  502406 | 1994 | 056124 | 1900-01-01 00:00:00 |  2 |    3.500 |    7.000 |
|  502407 | 1994 | 111201 | 1900-01-01 00:00:00 |  1 |    5.000 |    5.000 |
|  502408 | 1994 | 111102 | 1900-01-01 00:00:00 |  1 |    8.000 |    8.000 |
|  502409 | 1994 | 121101 | 1900-01-01 00:00:00 |  3 |   15.000 |   45.000 |
|  502410 | 1994 | 121101 | 1900-01-01 00:00:00 |  2 |    5.000 |   10.000 |
|  502411 | 1994 | 031307 | 1900-01-01 00:00:00 |  1 |    3.000 |    3.000 |
|  502412 | 1994 | 032111 | 1900-01-01 00:00:00 |  1 |   25.000 |   25.000 |
|  502413 | 1994 | 045201 | 1900-01-01 00:00:00 |  1 |    1.000 |    1.000 |
|  502414 | 1994 | 053102 | 1900-01-01 00:00:00 |  1 |   14.000 |   14.000 |
|  502415 | 1994 | 054001 | 1900-01-01 00:00:00 |  1 |   35.000 |   35.000 |
|  502416 | 1994 | 083005 | 1900-01-01 00:00:00 |  3 |   15.000 |   45.000 |
|  502417 | 1994 | 072201 | 1900-01-01 00:00:00 |  1 |    5.000 |    5.000 |
|  502425 | 1994 | 053109 | 1900-01-01 00:00:00 |  1 |   15.000 |   15.000 |
|  502426 | 1994 | 072201 | 1900-01-01 00:00:00 | 50 |    3.500 |  175.000 |
|  502427 | 1994 | 072204 | 1900-01-01 00:00:00 |  1 |    6.000 |    6.000 |
|  502428 | 1994 | 052007 | 1900-01-01 00:00:00 |  1 |    6.500 |    6.500 |
|  502429 | 1994 | 056203 | 1900-01-01 00:00:00 |  2 |  100.000 |  200.000 |
|  502456 | 1994 | 121102 | 1900-01-01 00:00:00 |  1 |   15.000 |   15.000 |
|  502457 | 1994 | 095401 | 1900-01-01 00:00:00 |  2 |    4.000 |    8.000 |
|  502458 | 1994 | 045201 | 1900-01-01 00:00:00 |  3 |    2.250 |    6.750 |
|  502459 | 1994 | 072201 | 1900-01-01 00:00:00 | 60 |    4.250 |  255.000 |
|  502462 | 1994 | 052001 | 1900-01-01 00:00:00 |  2 |   25.000 |   50.000 |
|  502464 | 1994 | 121304 | 1900-01-01 00:00:00 |  1 |    1.750 |    1.750 |
|  502465 | 1994 | 055204 | 1900-01-01 00:00:00 |  1 |   10.000 |   10.000 |
|  502466 | 1994 | 052012 | 1900-01-01 00:00:00 |  4 |   20.000 |   80.000 |
|  502467 | 1994 | 091105 | 1900-01-01 00:00:00 |  1 |    8.000 |    8.000 |
|  502468 | 1994 | 053215 | 1900-01-01 00:00:00 |  1 |   15.000 |   15.000 |
|  502469 | 1994 | 054014 | 1900-01-01 00:00:00 |  1 |   20.000 |   20.000 |
|  502470 | 1994 | 121304 | 1900-01-01 00:00:00 |  1 |    5.000 |    5.000 |
|  502471 | 1994 | 056126 | 1900-01-01 00:00:00 |  1 |    0.750 |    0.750 |
|  502472 | 1994 | 031280 | 1900-01-01 00:00:00 |  2 |    6.000 |   12.000 |
|  502473 | 1994 | 032103 | 1900-01-01 00:00:00 |  1 |    1.500 |    1.500 |
|  502474 | 1994 | 093105 | 1900-01-01 00:00:00 |  1 |    5.000 |    5.000 |
|  502475 | 1994 | 091406 | 1900-01-01 00:00:00 |  1 |   10.000 |   10.000 |
|  502476 | 1994 | 095201 | 1900-01-01 00:00:00 |  1 |    0.100 |    0.100 |
|  502477 | 1994 | 055206 | 1900-01-01 00:00:00 |  5 |    5.000 |   25.000 |
|  502478 | 1994 | 031260 | 1900-01-01 00:00:00 |  2 |   50.000 |  100.000 |
|  502479 | 1994 | 031274 | 1900-01-01 00:00:00 |  1 |   35.000 |   35.000 |
|  502480 | 1994 | 031306 | 1900-01-01 00:00:00 |  1 |   15.000 |   15.000 |
|  502481 | 1994 | 032103 | 1900-01-01 00:00:00 |  1 |    8.000 |    8.000 |
|  502500 | 1994 | 121302 | 1900-01-01 00:00:00 | 10 |    3.000 |   30.000 |
|  502501 | 1994 | 095201 | 1900-01-01 00:00:00 |  4 |    0.400 |    1.600 |
|  502502 | 1994 | 052001 | 1900-01-01 00:00:00 |  1 |   15.000 |   15.000 |
|  502503 | 1994 | 095201 | 1900-01-01 00:00:00 |  1 |    0.100 |    0.100 |
|  502504 | 1994 | 111201 | 1900-01-01 00:00:00 |  1 |   10.000 |   10.000 |
|  502505 | 1994 | 111102 | 1900-01-01 00:00:00 |  1 |   25.000 |   25.000 |
|  502506 | 1994 | 056114 | 1900-01-01 00:00:00 |  2 |    4.000 |    8.000 |
|  502507 | 1994 | 072202 | 1900-01-01 00:00:00 |  1 |    5.000 |    5.000 |
|  593137 | 2268 | 055206 | 1900-01-01 00:00:00 |  1 |    3.500 |    3.500 |
|  593138 | 2268 | 043104 | 1900-01-01 00:00:00 |  1 |    2.000 |    2.000 |
|  593139 | 2268 | 043104 | 1900-01-01 00:00:00 |  1 |    3.500 |    3.500 |
|  593140 | 2268 | 043207 | 1900-01-01 00:00:00 |  1 |   10.000 |   10.000 |
|  635705 | 2390 | 041102 | 1900-01-01 00:00:00 |  1 |   65.000 |   65.000 |
|  671617 | 2507 | 095408 | 1900-01-01 00:00:00 |  1 |    0.500 |    0.500 |
|  671621 | 2507 | 123103 | 1900-01-01 00:00:00 |  1 |   10.000 |   10.000 |
|  671622 | 2507 | 072201 | 1900-01-01 00:00:00 |  1 |    3.000 |    3.000 |
|  682666 | 2538 | 121302 | 1900-01-01 00:00:00 |  1 |    1.850 |    1.850 |
|  683236 | 2540 | 072201 | 1900-01-01 00:00:00 |  1 |    2.000 |    2.000 |
|  683237 | 2540 | 132003 | 1900-01-01 00:00:00 |  1 |   34.000 |   34.000 |
|  728035 | 2748 | 073202 | 1900-01-01 00:00:00 |  1 |    0.500 |    0.500 |
|  840860 | 3407 | 031286 | 1900-01-01 00:00:00 |  1 |   16.000 |   16.000 |
|  841242 | 3409 | 111102 | 1900-01-01 00:00:00 |  1 |   20.000 |   20.000 |
|  988438 | 3978 | 042101 | 1900-01-01 00:00:00 |  1 | 1000.000 | 1000.000 |
| 1005737 | 4048 | 121304 | 1900-01-01 00:00:00 |  1 |    2.000 |    2.000 |
| 1005738 | 4048 | 121304 | 1900-01-01 00:00:00 |  1 |    2.000 |    2.000 |
| 1005739 | 4048 | 121304 | 1900-01-01 00:00:00 |  1 |    1.500 |    1.500 |
+---------+------+--------+---------------------+----+----------+----------+
174 rows in set (5.21 sec)

mysql> select * from expense where year(d)=2003;
+--------+------+--------+---------------------+---+-------+-------+
| row    | f    | i      | d                   | q | p     | x     |
+--------+------+--------+---------------------+---+-------+-------+
| 726642 | 2739 | 056103 | 2003-08-25 00:00:00 | 1 | 0.200 | 0.200 |
| 726643 | 2739 | 073202 | 2003-08-26 00:00:00 | 1 | 0.500 | 0.500 |
| 726644 | 2739 | 111102 | 2003-08-26 00:00:00 | 1 | 0.750 | 0.750 |
| 726645 | 2739 | 072201 | 2003-08-27 00:00:00 | 1 | 2.000 | 2.000 |
| 726646 | 2739 | 111102 | 2003-08-27 00:00:00 | 1 | 3.000 | 3.000 |
| 726647 | 2739 | 073202 | 2003-08-28 00:00:00 | 1 | 0.500 | 0.500 |
| 726648 | 2739 | 056102 | 2003-08-28 00:00:00 | 1 | 0.250 | 0.250 |
| 726649 | 2739 | 095408 | 2003-08-29 00:00:00 | 1 | 0.300 | 0.300 |
| 726650 | 2739 | 095401 | 2003-08-29 00:00:00 | 1 | 0.200 | 0.200 |
| 726651 | 2739 | 072201 | 2003-08-30 00:00:00 | 1 | 2.500 | 2.500 |
| 726652 | 2739 | 083005 | 2003-08-30 00:00:00 | 1 | 3.000 | 3.000 |
| 726653 | 2739 | 073202 | 2003-08-31 00:00:00 | 1 | 0.500 | 0.500 |
| 726654 | 2739 | 111102 | 2003-08-31 00:00:00 | 1 | 0.750 | 0.750 |
+--------+------+--------+---------------------+---+-------+-------+
13 rows in set (2.06 sec)

mysql> select year(d),count(*) from expense group by year(d);
+---------+----------+
| year(d) | count(*) |
+---------+----------+
|    1900 |      174 |
|    2003 |       13 |
|    2012 |        1 |
|    2013 |  1038380 |
|    2014 |       12 |
|    2031 |        4 |
+---------+----------+
6 rows in set (3.34 sec)

mysql> select * from expense where year(d)=2012;
+--------+------+--------+---------------------+---+-------+-------+
| row    | f    | i      | d                   | q | p     | x     |
+--------+------+--------+---------------------+---+-------+-------+
| 299185 | 1271 | 044201 | 2012-11-01 00:00:00 | 1 | 1.000 | 1.000 |
+--------+------+--------+---------------------+---+-------+-------+
1 row in set (2.45 sec)

mysql> select * from expense where year(d)=2014;
+--------+------+--------+---------------------+---+--------+--------+
| row    | f    | i      | d                   | q | p      | x      |
+--------+------+--------+---------------------+---+--------+--------+
| 269986 | 1162 | 011908 | 2014-11-16 00:00:00 | 1 |  0.680 |  0.680 |
| 618579 | 2342 | 054006 | 2014-11-12 00:00:00 | 1 |  8.500 |  8.500 |
| 618580 | 2342 | 043104 | 2014-11-12 00:00:00 | 1 |  3.000 |  3.000 |
| 618581 | 2342 | 121304 | 2014-11-12 00:00:00 | 1 |  1.100 |  1.100 |
| 787934 | 3083 | 011101 | 2014-11-01 00:00:00 | 1 |  3.500 |  3.500 |
| 787935 | 3083 | 011701 | 2014-11-01 00:00:00 | 1 |  0.500 |  0.500 |
| 787936 | 3083 | 011730 | 2014-11-01 00:00:00 | 1 |  0.500 |  0.500 |
| 787937 | 3083 | 011118 | 2014-11-01 00:00:00 | 1 |  0.150 |  0.150 |
| 787938 | 3083 | 011118 | 2014-11-02 00:00:00 | 1 |  0.150 |  0.150 |
| 851198 | 3475 | 131008 | 2014-12-30 00:00:00 | 1 | 10.000 | 10.000 |
| 851199 | 3475 | 111201 | 2014-12-31 00:00:00 | 1 |  1.500 |  1.500 |
| 851200 | 3475 | 111102 | 2014-12-31 00:00:00 | 1 |  8.500 |  8.500 |
+--------+------+--------+---------------------+---+--------+--------+
12 rows in set (2.15 sec)

mysql> select * from expense where year(d)=2031;
+--------+------+--------+---------------------+---+--------+--------+
| row    | f    | i      | d                   | q | p      | x      |
+--------+------+--------+---------------------+---+--------+--------+
| 407309 | 1688 | 126201 | 2031-12-16 00:00:00 | 1 |  2.000 |  2.000 |
| 407310 | 1688 | 132007 | 2031-12-16 00:00:00 | 1 | 50.000 | 50.000 |
| 407311 | 1688 | 083006 | 2031-12-16 00:00:00 | 1 |  0.700 |  0.700 |
| 407312 | 1688 | 083005 | 2031-12-16 00:00:00 | 1 |  1.000 |  1.000 |
+--------+------+--------+---------------------+---+--------+--------+
4 rows in set (2.03 sec)

mysql> notee

mysql> insert into expense20161222 select * from expense;
Query OK, 1038584 rows affected (2 hours 39 min 29.45 sec)
Records: 1038584  Duplicates: 0  Warnings: 0

mysql> show tables;
ERROR 2006 (HY000): MySQL server has gone away
No connection. Trying to reconnect...
Connection id:    11
Current database: te050c

+-------------------+
| Tables_in_te050c  |
+-------------------+
| byproduct         |
| exp_std           |
| expense           |
| expense20161222   |
| expensefamily     |
| h                 |
| income            |
| incomefamily      |
| t0                |
| t1                |
| t2                |
| te050c_expense    |
| te050c_xl_expense |
| x                 |
+-------------------+
14 rows in set (0.02 sec)

mysql> create table income20161222 like income;
Query OK, 0 rows affected (0.28 sec)

mysql> insert into income20161222 select * from income;
Query OK, 21693 rows affected (4.46 sec)
Records: 21693  Duplicates: 0  Warnings: 0

select cast ( f as int(7)) as fi, cast (i as int(7)) as it,sum(q) as qt ,sum(x)/sum(q) as p from expense group by f,i;
